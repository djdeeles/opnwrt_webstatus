/*!
xCharts v0.3.0 Copyright (c) 2012, tenXer, Inc. All Rights Reserved.
@license MIT license. http://github.com/tenXer/xcharts for details
*/
(function(){function i(e){return _.chain(_.range(e,10)).reverse().map(function(e){return'g[data-index="'+e+'"]'}).value().join(", ")}function s(e,t){var n=e.getAttribute("class");return(n!==null?n.replace(/color\d+/g,""):"")+" color"+t}function a(e,t){return _.chain(e).pluck("data").flatten().pluck(t).uniq().filter(function(e){return e!==undefined&&e!==null}).value()}function f(e,t){var n=e[0],r=e[1],i,s;if(n===r){s=Math.max(Math.round(n/10),4);n-=s;r+=s}i=r-n;n=n?n-i/10:n;n=e[0]>0?Math.max(n,0):n;r=r?r+i/10:r;r=e[1]<0?Math.min(r,0):r;return[n,r]}function l(e,t,n,r){var i,s=_.chain(t).pluck("data").flatten().value();i={x:d3.extent(s,function(e){return e.x}),y:d3.extent(s,function(e){return e.y})};_.each([n,r],function(t,n){var r=n?"y":"x",o;i[r]=d3.extent(s,function(e){return e[r]});if(t==="ordinal"){return}_.each([r+"Min",r+"Max"],function(n,s){if(t!=="time"){o=f(i[r])}if(e.hasOwnProperty(n)&&e[n]!==null){i[r][s]=e[n]}else if(t!=="time"){i[r][s]=o[s]}})});return i}function p(){var e=document;return!!e.createElementNS&&!!e.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function e(e,t,n,r){var i=this,s;i._options=r=_.defaults(r||{},h);if(p()===false){return r.unsupported(n)}i._selector=n;i._container=d3.select(n);i._drawSvg();i._mainStorage={};i._compStorage={};t=_.clone(t);if(e&&!t.type){t.type=e}i.setData(t);d3.select(window).on("resize.for."+n,function(){if(s){clearTimeout(s)}s=setTimeout(function(){s=null;i._resize()},500)})}var e,t={},n={},r={};(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.3";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2);return x.map(e,function(e){return(x.isFunction(t)?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t){return x.isEmpty(t)?[]:x.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&65535>e.length)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;r.computed>o&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}),"value")};var L=function(e,t,n,r){var i={},s=k(t||x.identity);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;i>n.call(r,e[u])?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return T(e,function(e){x.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(a.apply(r,arguments))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=u.call(arguments),t=x.max(x.pluck(e,"length")),n=Array(t),r=0;t>r;r++)n[r]=x.pluck(e,""+r);return n},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){1>=arguments.length&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(e.bind===S&&S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(u.call(arguments)));O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}},x.bindAll=function(e){var t=u.call(arguments,1);return 0==t.length&&(t=x.functions(e)),T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t){var n,r,i,s,o=0,u=function(){o=new Date,i=null,s=e.apply(n,r)};return function(){var a=new Date,f=t-(a-o);return n=this,r=arguments,0>=f?(clearTimeout(i),i=null,o=a,s=e.apply(n,r)):i||(i=setTimeout(u,f)),s}},x.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,u=function(){r=null,n||(i=e.apply(s,o))},a=n&&!r;return clearTimeout(r),r=setTimeout(u,t),a&&(i=e.apply(s,o)),i}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return 1>--e?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&(t[t.length]=n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(o=e.length,u=o==t.length)for(;o--&&(u=M(e[o],t[o],n,r)););}else{var a=e.constructor,l=t.constructor;if(a!==l&&!(x.isFunction(a)&&a instanceof a&&x.isFunction(l)&&l instanceof l))return!1;for(var c in e)if(x.has(e,c)&&(o++,!(u=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(u){for(c in t)if(x.has(t,c)&&!(o--))break;u=!o}}return n.pop(),r.pop(),u};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),x.isFunction=function(e){return"function"==typeof e},x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(e),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return null;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=""+ ++P;return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n"," ":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){n=x.defaults({},n,x.templateSettings);var r=RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){return s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(s+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),i=u+t.length,t}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,x);var a=function(e){return o.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);r={getInsertionPoint:i,colorClass:s};var o=this,u=.25;n.ordinal=function(e,t,n,r){var i=a(e,t);return d3.scale.ordinal().domain(i).rangeRoundBands(n,u)};n.linear=function(e,t,n,r){return d3.scale.linear().domain(r).nice().rangeRound(n)};n.exponential=function(e,t,n,r){return d3.scale.pow().exponent(.65).domain(r).nice().rangeRound(n)};n.time=function(e,t,n,r){return d3.time.scale().domain(_.map(r,function(e){return new Date(e)})).range(n)};n.xy=function(t,n,r,i){var s=t._options,o=l(s,n,r,i),u={},a=[s.axisPaddingLeft,t._width],f=[t._height,s.axisPaddingTop],c,h;_.each([r,i],function(t,r){var i=r===0?"x":"y",s=r===0?a:f,l=e.getScale(t);u[i]=l(n,i,s,o[i])});return u};(function(){function s(e,t,n,r){e.xScale2=d3.scale.ordinal().domain(d3.range(0,n.length)).rangeRoundBands([0,e.xScale.rangeBand()],.08)}function o(t,s,o,u,a){var f,l,c=t.yZero;f=t._g.selectAll(n+o).data(u,function(e){return e.className});f.enter().insert("g",i).attr("data-index",e).style("opacity",0).attr("class",function(e,t){var n=_.uniq((o+e.className).split(".")).join(" ");return n+" bar "+r.colorClass(this,t)}).attr("transform",function(e,n){return"translate("+t.xScale2(n)+",0)"});l=f.selectAll("rect").data(function(e){return e.data},function(e){return e.x});l.enter().append("rect").attr("width",0).attr("rx",3).attr("ry",3).attr("x",function(e){return t.xScale(e.x)+t.xScale2.rangeBand()/2}).attr("height",function(e){return Math.abs(c-t.yScale(e.y))}).attr("y",function(e){return e.y<0?c:t.yScale(e.y)}).on("mouseover",a.mouseover).on("mouseout",a.mouseout).on("click",a.click);s.barGroups=f;s.bars=l}function u(e,t,n){var i=e.yZero;t.barGroups.attr("class",function(e,t){return r.colorClass(this,t)}).transition().duration(n).style("opacity",1).attr("transform",function(t,n){return"translate("+e.xScale2(n)+",0)"});t.bars.transition().duration(n).attr("width",e.xScale2.rangeBand()).attr("x",function(t){return e.xScale(t.x)}).attr("height",function(t){return Math.abs(i-e.yScale(t.y))}).attr("y",function(t){return t.y<0?i:e.yScale(t.y)})}function a(e,t,n){t.bars.exit().transition().duration(n).attr("width",0).remove();t.barGroups.exit().transition().duration(n).style("opacity",0).remove()}function f(e,t,n){var r=e.xScale2?e.xScale2.rangeBand()/2:0;delete e.xScale2;t.bars.transition().duration(n).attr("width",0).attr("x",function(t){return e.xScale(t.x)+r})}var e=2,n="g.bar",i=r.getInsertionPoint(e);t.bar={postUpdateScale:s,enter:o,update:u,exit:a,destroy:f}})();(function(){function s(t,s,o,u,a){function g(e){return[e.data]}var f=t._options.interpolation,l=function(e,n){if(!t.xScale2&&!t.xScale.rangeBand){return t.xScale(e.x)}return t.xScale(e.x)+t.xScale.rangeBand()/2},c=function(e){return t.yScale(e.y)},h=d3.svg.line().x(l).interpolate(f),p=d3.svg.area().x(l).y1(t.yZero).interpolate(f),d,v,m;d=t._g.selectAll(n+o).data(u,function(e){return e.className});d.enter().insert("g",i).attr("data-index",e).attr("class",function(e,t){var n=_.uniq((o+e.className).split(".")).join(" ");return n+" line "+r.colorClass(this,t)});v=d.selectAll("path.fill").data(g);v.enter().append("path").attr("class","fill").style("opacity",0).attr("d",p.y0(c));m=d.selectAll("path.line").data(g);m.enter().append("path").attr("class","line").style("opacity",0).attr("d",h.y(c));s.lineContainers=d;s.lineFills=v;s.linePaths=m;s.lineX=l;s.lineY=c;s.lineA=p;s.line=h}function o(e,t,n){t.lineContainers.attr("class",function(e,t){return r.colorClass(this,t)});t.lineFills.transition().duration(n).style("opacity",1).attr("d",t.lineA.y0(t.lineY));t.linePaths.transition().duration(n).style("opacity",1).attr("d",t.line.y(t.lineY))}function u(e,t){t.linePaths.exit().style("opacity",0).remove();t.lineFills.exit().style("opacity",0).remove();t.lineContainers.exit().remove()}function a(e,t,n){t.linePaths.transition().duration(n).style("opacity",0);t.lineFills.transition().duration(n).style("opacity",0)}var e=3,n="g.line",i=r.getInsertionPoint(e);t.line={enter:s,update:o,exit:u,destroy:a}})();(function(){function n(t,n,r,i,s){var o;e.enter(t,n,r,i,s);o=n.lineContainers.selectAll("circle").data(function(e){return e.data},function(e){return e.x});o.enter().append("circle").style("opacity",0).attr("cx",n.lineX).attr("cy",n.lineY).attr("r",5).on("mouseover",s.mouseover).on("mouseout",s.mouseout).on("click",s.click);n.lineCircles=o}function r(t,n,r){e.update.apply(null,_.toArray(arguments));n.lineCircles.transition().duration(r).style("opacity",1).attr("cx",n.lineX).attr("cy",n.lineY)}function i(t,n){n.lineCircles.exit().remove();e.exit.apply(null,_.toArray(arguments))}function s(t,n,r){e.destroy.apply(null,_.toArray(arguments));if(!n.lineCircles){return}n.lineCircles.transition().duration(r).style("opacity",0)}var e=t.line;t["line-dotted"]={enter:n,update:r,exit:i,destroy:s}})();(function(){function n(t,n,r,i,s){e.enter(t,n,r,i,s)}function r(e){function t(e,t){return e+t.y}var n=_.map(e,function(e){var n=e.data.length,r=_.clone(e.data);e=_.clone(e);while(n){n-=1;r[n]=_.clone(e.data[n]);r[n].y0=e.data[n].y;r[n].y=_.reduce(_.first(e.data,n),t,e.data[n].y)}return _.extend(e,{data:r})});return n}function i(e){if(!e.hasOwnProperty("cumulativeOMainData")){return}e._mainData=e.cumulativeOMainData;delete e.cumulativeOMainData;e._compData=e.cumulativeOCompData;delete e.cumulativeOCompData}function s(e,t){i(e);e.cumulativeOMainData=e._mainData;e._mainData=r(e._mainData);e.cumulativeOCompData=e._compData;e._compData=r(e._compData)}function o(t,n,r){i(t);e.destroy.apply(null,_.toArray(arguments))}var e=t["line-dotted"];t.cumulative={preUpdateScale:s,enter:n,update:e.update,exit:e.exit,destroy:o}})();var c=[[]],h={mouseover:function(e,t){},mouseout:function(e,t){},click:function(e,t){},axisPaddingTop:0,axisPaddingRight:0,axisPaddingBottom:5,axisPaddingLeft:20,paddingTop:0,paddingRight:0,paddingBottom:20,paddingLeft:60,tickHintX:10,tickFormatX:function(e){return e},tickHintY:10,tickFormatY:function(e){return e},xMin:null,xMax:null,yMin:null,yMax:null,dataFormatX:function(e){return e},dataFormatY:function(e){return e},unsupported:function(e){d3.select(e).text("SVG is not supported on your browser")},empty:function(e,t,n){},notempty:function(e,t){},timing:750,interpolation:"monotone",sortX:function(e,t){return!e.x&&!t.x?0:e.x<t.x?-1:1}};e.setVis=function(e,n){if(t.hasOwnProperty(e)){throw'Cannot override vis type "'+e+'".'}t[e]=n};e.getVis=function(e){if(!t.hasOwnProperty(e)){throw'Vis type "'+e+'" does not exist.'}return _.clone(t[e])};e.setScale=function(e,t){if(n.hasOwnProperty(e)){throw'Scale type "'+e+'" already exists.'}n[e]=t};e.getScale=function(e){if(!n.hasOwnProperty(e)){throw'Scale type "'+e+'" does not exist.'}return n[e]};e.visutils=r;_.defaults(e.prototype,{setType:function(e,n){var r=this;if(r._type&&e===r._type){return}if(!t.hasOwnProperty(e)){throw'Vis type "'+e+'" is not defined.'}if(r._type){r._destroy(r._vis,r._mainStorage)}r._type=e;r._vis=t[e];if(!n){r._draw()}},setData:function(e){function i(e){var t=_.map(_.clone(e.data),function(e){var t=_.clone(e);if(e.hasOwnProperty("x")){t.x=n.dataFormatX(e.x)}if(e.hasOwnProperty("y")){t.y=n.dataFormatY(e.y)}return t});return _.extend(_.clone(e),{data:t})}var t=this,n=t._options,r=_.clone(e);if(!e.hasOwnProperty("main")){throw'No "main" key found in given chart data.'}switch(e.type){case"bar":e.xScale="ordinal";break;case undefined:e.type=t._type;break}n.xMin=isNaN(parseInt(e.xMin,10))?n.xMin:e.xMin;n.xMax=isNaN(parseInt(e.xMax,10))?n.xMax:e.xMax;n.yMin=isNaN(parseInt(e.yMin,10))?n.yMin:e.yMin;n.yMax=isNaN(parseInt(e.yMax,10))?n.yMax:e.yMax;if(t._vis){t._destroy(t._vis,t._mainStorage)}t.setType(e.type,true);r.main=_.map(r.main,i);t._mainData=r.main;t._xScaleType=r.xScale;t._yScaleType=r.yScale;if(r.hasOwnProperty("comp")){r.comp=_.map(r.comp,i);t._compData=r.comp}else{t._compData=[]}t._draw()},setScale:function(e,t){var n=this;switch(e){case"x":n._xScaleType=t;break;case"y":n._yScaleType=t;break;default:throw'Cannot change scale of unknown axis "'+e+'".'}n._draw()},_drawSvg:function(){var e=this,t=e._container,n=e._options,r=parseInt(t.style("width").replace("px",""),10),i=parseInt(t.style("height").replace("px",""),10),s,o,u;s=t.selectAll("svg").data(c);s.enter().append("svg").attr("height",i).attr("width",r).attr("class","xchart");s.transition().attr("width",r).attr("height",i);o=s.selectAll("g").data(c);o.enter().append("g").attr("transform","translate("+n.paddingLeft+","+n.paddingTop+")");u=o.selectAll("g.scale").data(c);u.enter().append("g").attr("class","scale");e._svg=s;e._g=o;e._gScale=u;e._height=i-n.paddingTop-n.paddingBottom-n.axisPaddingTop-n.axisPaddingBottom;e._width=r-n.paddingLeft-n.paddingRight-n.axisPaddingLeft-n.axisPaddingRight},_resize:function(e){var t=this;t._drawSvg();t._draw()},_drawAxes:function(){if(this._noData){return}var e=this,t=e._options,n=e._gScale.transition().duration(t.timing),r=t.tickHintX,i=t.tickHintY,s=e._height+t.axisPaddingTop+t.axisPaddingBottom,o=d3.svg.line().x(function(e){return e}),u,a,f,l,h,p,d;l=d3.svg.axis().scale(e.xScale).ticks(r).tickSize(-e._height).tickFormat(t.tickFormatX).orient("bottom");f=e._gScale.selectAll("g.axisX").data(c);f.enter().append("g").attr("class","axis axisX").attr("transform","translate(0,"+s+")");f.call(l);d=e._gScale.selectAll(".axisX g")[0];if(d.length>e._width/80){d;d3.selectAll(d).filter(function(e,t){return t%(Math.ceil(d.length/r)+1)}).remove()}p=d3.svg.axis().scale(e.yScale).ticks(i).tickSize(-e._width-t.axisPaddingRight-t.axisPaddingLeft).tickFormat(t.tickFormatY).orient("left");h=e._gScale.selectAll("g.axisY").data(c);h.enter().append("g").attr("class","axis axisY").attr("transform","translate(0,0)");n.selectAll("g.axisY").call(p);u=e._gScale.selectAll("g.axisZero").data([[]]);u.enter().append("g").attr("class","axisZero");a=u.selectAll("line").data([[]]);a.enter().append("line").attr("x1",0).attr("x2",e._width+t.axisPaddingLeft+t.axisPaddingRight).attr("y1",e.yZero).attr("y2",e.yZero);a.transition().duration(t.timing).attr("y1",e.yZero).attr("y2",e.yZero)},_updateScale:function(){var e=this,t=function(){return _.union(e._mainData,e._compData)},r=t(),i=e._vis,s,o;delete e.xScale;delete e.yScale;delete e.yZero;if(i.hasOwnProperty("preUpdateScale")){i.preUpdateScale(e,r,e._mainData,e._compData)}r=t();s=n.xy(e,r,e._xScaleType,e._yScaleType);e.xScale=s.x;e.yScale=s.y;o=e.yScale.domain()[0];e.yZero=o>0?e.yScale(o):e.yScale(0);if(i.hasOwnProperty("postUpdateScale")){i.postUpdateScale(e,r,e._mainData,e._compData)}},_enter:function(e,t,n,r){var i=this,s={click:i._options.click,mouseover:i._options.mouseover,mouseout:i._options.mouseout};i._checkVisMethod(e,"enter");e.enter(i,t,r,n,s)},_update:function(e,t){var n=this;n._checkVisMethod(e,"update");e.update(n,t,n._options.timing)},_exit:function(e,t){var n=this;n._checkVisMethod(e,"exit");e.exit(n,t,n._options.timing)},_destroy:function(e,t){var n=this;n._checkVisMethod(e,"destroy");try{e.destroy(n,t,n._options.timing)}catch(r){}},_draw:function(){var e=this,n=e._options,r,i;e._noData=_.flatten(_.pluck(e._mainData,"data").concat(_.pluck(e._compData,"data"))).length===0;e._updateScale();e._drawAxes();e._enter(e._vis,e._mainStorage,e._mainData,".main");e._exit(e._vis,e._mainStorage);e._update(e._vis,e._mainStorage);r=_.chain(e._compData).groupBy(function(e){return e.type});i=r.keys();_.each(e._compStorage,function(n,r){if(-1===i.indexOf(r).value()){var s=t[r];e._enter(s,n,[],".comp."+r.replace(/\W+/g,""));e._exit(s,n)}});r.each(function(n,r){var i=t[r],s;if(!e._compStorage.hasOwnProperty(r)){e._compStorage[r]={}}s=e._compStorage[r];e._enter(i,s,n,".comp."+r.replace(/\W+/g,""));e._exit(i,s);e._update(i,s)});if(e._noData){n.empty(e,e._selector,e._mainData)}else{n.notempty(e,e._selector)}},_checkVisMethod:function(e,t){var n=this;if(!e[t]){throw'Required method "'+t+'" not found on vis type "'+n._type+'".'}}});if(typeof define==="function"&&define.amd&&typeof define.amd==="object"){define(function(){return e});return}window.xChart=e})()